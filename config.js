// --- U-M THEME CONSTANTS ---
const UM_BLUE = '#00274C';
const UM_MAIZE = '#FFCB05';
const UM_BLUE_LIGHT = '#B0D0DB';
const UM_TEXT_ON_MAIZE = '#00274C'; // Text color for maize backgrounds

// --- ABBREVIATIONS & TAG RULES ---
const abbreviationMap = { "JanClos": "Janitorial Closet", "CleanRm": "Clean Room", "MaintRm": "Maintenance Room", "ExamRm": "Examination Room", "ProcedRm": "Procedure Room", "TrainingRm": "Training Room", "TestRm": "Testing Room", "AnteRm": "Anteroom", "ScrubRm": "Scrub Room", "CallRm": "Call Room", "TubRm": "Tub Room", "ControlRm": "Control Room", "CopyRm": "Copy Room", "StaffRm": "Staff Room", "RecovryRm": "Recovery Room", "StaffLkrRm": "Staff Locker Room", "StrlzerRm": "Sterilizer Room", "StaffShowr": "Staff Shower", "FileRm": "File Room", "ObsrvtnRm": "Observation Room", "PatDress": "Patient Dressing Room", "PatPrep": "Patient Preparation Room", "LockerRm": "Locker Room", "TeamngArea": "Teaming Area", "PatnLounge": "Patient Lounge", "DptLounge": "Department Lounge", "ParntSleep": "Parent Sleep Area", "ParntShwr": "Parent Shower", "NurishmtRm": "Nourishment Room", "PatnKitchn": "Patient Kitchen", "RecepArea": "Reception Area", "OpenWkSta": "Open Workstation", "FlxOpnWkSt": "Flexible Open Workstation", "FlexCubicl": "Flexible Cubicle", "FlexOffice": "Flexible Office", "CompSuppt": "Computer Support", "ReceptWtg": "Reception Waiting", "ReceptClrk": "Reception Clerk", "LobbyVest": "Lobby Vestibule", "MedSupply": "Medical Supply", "PharSupply": "Pharmacy Supply", "SterileStg": "Sterile Storage", "MedGasStrg": "Medical Gas Storage", "VndgWOStg": "Vending with Storage", "SoiledLin": "Soiled Linen", "ClnLin": "Clean Linen", "StrlSoiled": "Sterile Soiled", "StrlStrg": "Sterile Storage", "SupplyRm": "Supply Room", "StorageRm": "Storage Room", "StockRm": "Stock Room", "DptStorage": "Department Storage", "EqmtStrgRm": "Equipment Storage Room", "SuplStgRm": "Supply Storage Room", "ImEquipSup": "Imaging Equipment Supply", "StrlInsSup": "Sterile Instrument Supply", "SrgySupEqm": "Surgery Supply Equipment", "ClnLnMdSup": "Clean Linen Medical Supply", "ClnLin/MdS": "Clean Linen/Medical Supply", "SoiLinSupl": "Soiled Linen Supply", "CServSupp": "Central Service Support", "CentralSup": "Central Supply", "DiagLabSup": "Diagnostic Lab Supply", "DiagTrtmt": "Diagnostic Treatment", "TherTrtmt": "Therapy Treatment", "SurgerySvc": "Surgery Service", "HazardMat": "Hazardous Materials", "AssignCir": "Assigned Circulation", "AssignCirc": "Assigned Circulation", "ExtendStay": "Extended Stay", "InPatnt": "Inpatient", "OutPtToilt": "Outpatient Toilet", "PreOpPtPre": "Pre-Op Patient Prep", "FoodFacSvc": "Food Facility Service", "FoodStPrep": "Food Service Preparation", "Circulat'n": "Circulation", "PublicWait": "Public Waiting", "PubCorr": "Public Corridor", "AsgnToilet": "Assigned Toilet", "StffToilet": "Staff Toilet", "OutPtClsRm": "Outpatient Closet Room", "PubRestRm": "Public Restroom", "AlGnHandic": "All Gender Handicap", "AlGnRestRm": "All Gender Restroom", "Men-Handic": "Men's Handicap", "Wmn-Handic": "Women's Handicap", "DptBreak": "Department Break Room", "DptKitchen": "Department Kitchen", "DptMail": "Department Mail", "Treat/Exam": "Treatment/Examination", "Tr/ExamSvc": "Treatment/Examination Service", "ExamSvc": "Examination Service", "PatienBdrm": "Patient Bedroom", "PatientBth": "Patient Bathroom", "InPatnBth": "In Patient Bathroom", "PatBedSvc": "Patient Bed Service", "NurseStnSr": "Nurse Station Service", "Nurse Stat": "Nurse's Station", "StaffOnCal": "Staff On Call", "StfOnCallS": "Staff On Call Service", "AssemblySv": "Assembly Service", "MerchSvc": "Merchandise Service", "merchandsg": "Merchandising", "MedProdSvc": "Medical Product Service", "RadCT": "Radiology CT", "RadIR": "Radiology Interventional", "RadMRI": "Radiology MRI", "RadNucMed": "Radiology Nuclear Medicine", "RadUltrasd": "Radiology Ultrasound", "RadXRay": "Radiology X-Ray", "DiagSrvLab": "Diagnostic Service Laboratory", "IsotopeRm": "Isotope Room", "FilmPrView": "Film Preview", "BldDrawSta": "Blood Draw Station", "ProsthShop": "Prosthetics Shop", "PhotogSvc": "Photography Service", "ChartFFRm": "Charting/Forms/Files Room", "Decontamin": "Decontamination", "PrepStgRm": "Preparation Staging Room", "ConsultRm": "Consultation Room", "PsychPtIso": "Psychiatric Patient Isolation", "InPatnICU": "Inpatient ICU", "InPatnIso": "Inpatient Isolation", "InPatnPsyc": "Inpatient Psychiatric", "LbrDeliIso": "Labor Delivery Isolation", "LbrDeliv": "Labor Delivery", "NeoICU": "Neonatal ICU", "NeoICUIso": "Neonatal ICU Isolation", "PedInPtPsy": "Pediatric Inpatient Psychiatric", "PedsICU": "Pediatric ICU", "AcThTrtRm": "Acute Therapy Treatment Room", "InPatClsRm": "Inpatient Classroom", "ActPlayRm": "Activity/Play Room", "PatFamAmen": "Patient Family Amenities", "HseOfcrOnC": "House Officer On Call", "MedStuOnC": "Medical Student On Call", "On-CallRm": "On-Call Room", "OnCallClst": "On Call Closet", "OnCallLnge": "On Call Lounge", "OnCllBthrm": "On Call Bathroom", "Ctrl/Obsrv": "Control/Observation", "HVAC": "Heating, Ventilation, and Air Conditioning", "ElectEquip": "Electrical Equipment", "MechEquip": "Mechanical Equipment", "VertShaft": "Vertical Shaft", "Comm": "Communications", "Off.": "Office", "Off": "Office", "Mech.": "Mechanical", "Mech": "Mechanical", "Admin.": "Administration", "Admin": "Administration", "Lab.": "Laboratory", "Lab": "Laboratory", "Stor.": "Storage", "Stor": "Storage", "WC": "Bathroom", "Restroom": "Bathroom", "Corr.": "Corridor", "Corr": "Corridor" };
const fullReplacements = { "Circulation Public Corridor": "Corridor", "Circulation Lobby Vestibule": "Lobby", "Circulation Stair": "Stairwell", "Circulation Elevator": "Elevator", "Circulation Dock": "Loading Dock", "Public Toilet Uni-Sex": "Unisex Public Bathroom", "Public Toilet Men": "Men's Public Bathroom", "Public Toilet Women": "Women's Public Bathroom", "OutPtToilt": "Public Bathroom", "Mechanical Electrical Equipment": "Electrical Room", "Mechanical Mechanical Equipment": "Mechanical Room", "Mechanical HVAC": "HVAC Room", "Mechanical Vertical Shaft": "Vertical Shaft", "Mechanical Communications": "Communications Room", "HazardMat HazardMat": "Hazardous Materials Storage", "Conference Conference": "Conference Room", "Office Office": "Office", "Surgery Operating": "Operating Room" };
const tagRules = [ { pattern: /patient|bed|family/i, tag: "patient-care" }, { pattern: /office|admin|conference|meeting|lounge/i, tag: "administration" }, { pattern: /exam|treatment|therapy|medical|nurse|clinic|surgery|operating/i, tag: "clinical" }, { pattern: /toilet|bathroom|shower|restroom|wc/i, tag: "restroom" }, { pattern: /outpatient toilet|public toilet|pub.*restroom/i, tag: "public-restroom" }, { pattern: /storage|supply|equipment|closet/i, tag: "storage" }, { pattern: /mechanical|electrical|maintenance|hvac|communications/i, tag: "infrastructure" }, { pattern: /corridor|stair|elevator|lobby|circulation/i, tag: "circulation" }, { pattern: /kitchen|food|dining/i, tag: "food-service" }, { pattern: /laboratory|diagnostic|radiology|imaging/i, tag: "diagnostic" } ];